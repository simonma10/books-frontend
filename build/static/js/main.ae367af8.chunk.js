(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){e.exports=a(69)},60:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(35),o=a.n(l),r=a(15),i=a(2),c=a(4),d=a(5),u=a(7),m=a(6),h=a(1),p=a(8),g=a(10),b=a.n(g),v=a(36),E=a(16),k=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleLogout=a.handleLogout.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"handleLogout",value:function(){this.props.handleLogout()}},{key:"render",value:function(){var e=this.props.user.username||"";return s.a.createElement("nav",{className:"navbar sticky-top navbar-expand-lg navbar-dark bg-dark"},"  ",s.a.createElement("span",{className:"navbar-brand mb-0 h1"},s.a.createElement("i",{className:"fas fa-book"})," Funky Books"),s.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},s.a.createElement("span",{className:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},s.a.createElement("ul",{className:"navbar-nav mr-auto"},s.a.createElement("li",{className:"nav-item"},s.a.createElement("a",{className:"nav-link",href:"/"},"My BookList")),"admin"===this.props.user.role?s.a.createElement("li",{className:"nav-item"},s.a.createElement("a",{className:"nav-link",href:"/users"},"Users")):s.a.createElement("span",null)),s.a.createElement("div",{className:"ml-4 mr-2"},""===e?s.a.createElement("button",{type:"button",className:"btn btn-primary btn-sm","data-toggle":"modal","data-target":".login-modal"},"Login"):s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"mr-1 d-flex flex-column justify-content-center text-light"},e),s.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:this.handleLogout},"Logout")," "))))}}]),t}(n.Component);a(60);a(61).config();var f="https://limitless-headland-66330.herokuapp.com",y={modalName:"bookEditModal",baseUrl:f+"/api/v1/books",searchUrl:f+"/api/v1/external/google/volumes",routesUrl:f+"/routes",loginUrl:f+"/login",usersUrl:f+"/users",statusOptions:[{name:"None",value:"none"},{name:"Wishlist",value:"wishlist"},{name:"On Order",value:"onOrder"},{name:"Purchased",value:"purchased"},{name:"Reading",value:"reading"},{name:"Read",value:"read"}],priorityOptions:[{name:"None",value:"none"},{name:"0",value:0},{name:"1",value:1},{name:"2",value:2},{name:"3",value:3},{name:"4",value:4},{name:"5",value:5}]};var N=function(e){return s.a.createElement("div",{className:"modal fade user-edit-modal",tabIndex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("form",null,s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",null,e.mode," User")),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"editUserUsername"},"Username"),s.a.createElement("input",{type:"text",className:"form-control",id:"editUserUsername","aria-describedby":"usernameHelp",placeholder:"Enter username",value:e.user.username,name:"username",onChange:function(t){e.handleChange(t.target.name,t.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"editUserPassword"},"Password"),s.a.createElement("input",{type:"password",className:"form-control",id:"editUserPassword","aria-describedby":"usernameHelp",placeholder:"Enter password",value:e.user.password,name:"password",onChange:function(t){e.handleChange(t.target.name,t.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"editUserEmail"},"Email"),s.a.createElement("input",{type:"email",className:"form-control",id:"editUserEmail",placeholder:"Email address",value:e.user.email,name:"email",onChange:function(t){e.handleChange(t.target.name,t.target.value)}})),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"form-group col-8"},s.a.createElement("label",{htmlFor:"editUserRole"},"Role"),s.a.createElement("select",{value:e.user.role||"",onChange:function(t){e.handleChange(t.target.name,t.target.value)},className:"form-control",id:"editUserRole",name:"role"},s.a.createElement("option",{value:"guest"},"Guest"),s.a.createElement("option",{value:"user"},"User"),s.a.createElement("option",{value:"admin"},"Admin"))),s.a.createElement("div",{className:"form-group form-check col-4"},s.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"editUserActive",checked:e.user.active,name:"active",onChange:function(t){e.handleChange(t.target.name,!e.user.active)}}),s.a.createElement("label",{className:"form-check-label",htmlFor:"editUserActive"},"Active")))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),s.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:e.handleSubmit},"Submit"))))))},C=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(u.a)(this,Object(m.a)(t).call(this,e));var n=JSON.parse(localStorage.getItem("user"));return a.state={users:[],isUsersLoading:!1,user:n,editUser:{_id:"",username:"",password:"",email:"",role:"",active:!0},mode:""},a.handleEditClick=a.handleEditClick.bind(Object(h.a)(a)),a.handleEditChange=a.handleEditChange.bind(Object(h.a)(a)),a.handleEditSubmit=a.handleEditSubmit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){null===this.state.user&&console.log("user not loaded"),this.getUsers()}},{key:"getRequestOptions",value:function(){return{headers:{Authorization:"Basic "+this.state.user.authdata}}}},{key:"getUsers",value:function(){var e=this;this.setState(Object(i.a)({},this.state,{isUsersLoading:!0}));var t=y.usersUrl,a=this.getRequestOptions();b.a.get(t,a).then(function(t){e.setState({users:t.data,isUsersLoading:!1})}).catch(function(t){console.log(t),e.setState({error:!0,isUsersLoading:!1})})}},{key:"updateUser",value:function(e){var t=this,a=y.usersUrl;b.a.patch(a,e,this.getRequestOptions()).then(function(e){200===e.status&&(console.log("User updated successfully"),t.getUsers())}).catch(function(e){console.log("Error updating user")})}},{key:"deleteUser",value:function(e){var t=this;console.log("deleteUser",e);var a=y.usersUrl+"?id="+e._id;b.a.delete(a,this.getRequestOptions()).then(function(e){200===e.status&&(console.log("User deleted successfully"),t.getUsers())}).catch(function(e){console.log(e)})}},{key:"createUser",value:function(e){var t=this,a=y.usersUrl;b.a.post(a,e,this.getRequestOptions()).then(function(a){200===a.status&&(console.log(e.username,"created successfully"),t.getUsers())}).catch(function(e){console.log(e)})}},{key:"toggleActive",value:function(e){var t=e;t.active=!t.active,this.updateUser(t)}},{key:"handleEditClick",value:function(e){"New"===e?this.setState({editUser:{_id:"",username:"",password:"",email:"",role:"",active:!0},mode:"New"}):this.setState({editUser:e,mode:"Edit"})}},{key:"handleEditChange",value:function(e,t){this.setState({editUser:Object(i.a)({},this.state.editUser,Object(r.a)({},e,t))})}},{key:"handleEditSubmit",value:function(){"New"===this.state.mode?this.createUser(this.state.editUser):this.updateUser(this.state.editUser)}},{key:"renderUserList",value:function(){var e=this;if(this.state.users.length>0)return this.state.users.map(function(t,a){return[s.a.createElement("div",{className:"row mb-2",key:a},s.a.createElement("div",{className:"col-3"},t.username),s.a.createElement("div",{className:"col-5"},t.email),s.a.createElement("div",{className:"col-1"},t.role),s.a.createElement("div",{className:"col-1"},s.a.createElement("button",{className:"btn btn-primary btn-sm","data-toggle":"modal","data-target":".user-edit-modal",onClick:function(){return e.handleEditClick(t)}},s.a.createElement("span",null,"EditUser"))),s.a.createElement("div",{className:"col-1"},s.a.createElement("button",{className:"btn btn-warning btn-sm",onClick:function(){e.toggleActive(t)}},t.active?s.a.createElement("span",null,"Deactivate"):s.a.createElement("span",null,"Activate"))),s.a.createElement("div",{className:"col-1"},s.a.createElement("button",{className:"btn btn-danger btn-sm",onClick:function(){e.deleteUser(t)}},"Delete")))]})}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"text-center mt-3"},s.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading...")))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("nav",{className:"navbar sticky-top navbar-expand-lg navbar-light bg-light"},"  ",s.a.createElement("span",{className:"navbar-brand mb-0 h1"},"Users")),s.a.createElement("div",{className:"row justify-content-center"},s.a.createElement("div",{className:"col-11"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-3"},s.a.createElement("strong",null,"Username")),s.a.createElement("div",{className:"col-5"},s.a.createElement("strong",null,"Email")),s.a.createElement("div",{className:"col-1"},s.a.createElement("strong",null,"Role")),s.a.createElement("div",{className:"col-3 text-center"},s.a.createElement("strong",null,"Actions"))),s.a.createElement("hr",null)),s.a.createElement("div",{className:"col-11"},this.state.isUsersLoading?this.renderSpinner():this.renderUserList()),s.a.createElement(N,{user:this.state.editUser,handleChange:this.handleEditChange,handleSubmit:this.handleEditSubmit,mode:this.state.mode})),s.a.createElement("div",{className:"row justify-content-center"},s.a.createElement("div",{className:"col-11 justify-content-end"},s.a.createElement("hr",null),s.a.createElement("button",{className:"btn btn-success btn-sm","data-toggle":"modal","data-target":".user-edit-modal",onClick:function(){e.handleEditClick("New")}},"New User"))))}}]),t}(n.Component),S=a(12),O=a.n(S),B=a(17),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={bookId:e.bookId,starsFromProps:e.priority,starsTemp:0},a.handleMouseOver=a.handleMouseOver.bind(Object(h.a)(a)),a.handleMouseOut=a.handleMouseOut.bind(Object(h.a)(a)),a.handleClick=a.handleClick.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({starsTemp:this.state.starsFromProps})}},{key:"emptyStar",value:function(){return s.a.createElement("i",{className:"far fa-star"})}},{key:"filledStar",value:function(){return s.a.createElement("i",{className:"fas fa-star"})}},{key:"numToArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=[],n=1;n<t+1;n++)n<=e?a.push(1):a.push(0);return a}},{key:"handleMouseOver",value:function(e){this.setState({starsTemp:e+1})}},{key:"handleMouseOut",value:function(){this.setState({starsTemp:this.state.starsFromProps})}},{key:"handleClick",value:function(e){this.props.handleStarClick(e+1,this.state.bookId),this.setState({starsFromProps:e+1,starsTemp:e+1})}},{key:"render",value:function(){var e=this,t=this.numToArray(this.state.starsTemp);return s.a.createElement("div",{className:"row text-warning"},t.map(function(t,a){return s.a.createElement("span",{key:a,onMouseOver:function(){return e.handleMouseOver(a)},onMouseOut:function(){e.handleMouseOut()},onClick:function(){return e.handleClick(a)}},1===t?s.a.createElement("span",null,e.filledStar()):s.a.createElement("span",null,e.emptyStar()))}))}}]),t}(n.Component);var w=function(e){var t=e.book,a="https://books.google.com/books/content?id=";t.googleBooksId&&""!==t.googleBooksId?a+=t.googleBooksId:a+="ZlU3DwAAQBAJ",a+="&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api";var n="";return t.snippet&&(n=(n=t.snippet.replace(/&quot;/g,'"')).replace(/&#39;/g,"'")),s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-header"},s.a.createElement("div",{className:"media"},s.a.createElement("img",{src:a,className:"mr-2 bl-thumb",alt:"book cover"}),s.a.createElement("div",{className:"media-body"},s.a.createElement("div",{className:"container-fluid row"},s.a.createElement("div",{className:"col-3"},s.a.createElement("h6",{className:"mt-0"},s.a.createElement("strong",null,t.title||"loading"," ")),s.a.createElement("div",{className:"d-flex flex-row justify-content-between"},s.a.createElement("div",null,t.author,"   ",s.a.createElement("span",null,t.year?s.a.createElement("span",null,"(",t.year,")"):s.a.createElement("span",null))))),s.a.createElement("div",{className:"col-6",style:{position:"relative"}},s.a.createElement("p",null,s.a.createElement("small",null,n)),e.bookUpdatingId===e.book._id?s.a.createElement("div",{className:"col-12 text-center mt-3",style:{position:"absolute",left:"0px",top:"0px"}},s.a.createElement("div",{className:"spinner-grow text-secondary",role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading..."))):s.a.createElement("span",null)),s.a.createElement("div",{className:"col-3"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-6"},s.a.createElement("div",{className:"mr-1 mb-4"},s.a.createElement("select",{value:t.status||"",onChange:function(a){e.selectHandler(a,t._id)}},s.a.createElement("option",{value:"wishlist"},"Wishlist"),s.a.createElement("option",{value:"onOrder"},"On Order"),s.a.createElement("option",{value:"purchased"},"Purchased"),s.a.createElement("option",{value:"reading"},"Reading"),s.a.createElement("option",{value:"read"},"Read"))),s.a.createElement("div",{className:"mr-1 ml-3"},s.a.createElement(j,{priority:t.priority,bookId:t._id,handleStarClick:function(t,a){return e.handleStarClick(t,a)}}))),s.a.createElement("div",{className:"col-6"},s.a.createElement("div",{className:"mr-1 ml-3 mb-3"},s.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"edit book"},s.a.createElement("span",{style:{fontSize:"1.2em"},className:"mr-3 text-primary","data-toggle":"modal","data-target":"#"+y.modalName,onClick:function(){e.clickHandler(t._id)}},s.a.createElement("i",{className:"fas fa-edit"}))),s.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"delete book"},s.a.createElement("span",{style:{fontSize:"1.2em"},className:"text-danger","data-toggle":"modal","data-target":".yes-no-modal",onClick:function(){e.clickHandler(t._id)}},s.a.createElement("i",{className:"fas fa-trash-alt"})))),s.a.createElement("div",{className:""},s.a.createElement("button",{type:"button",className:"btn btn-link","data-toggle":"collapse","data-target":"#collapse"+t._id},s.a.createElement("small",null,"details...")))))))))),s.a.createElement("div",{className:"collapse",id:"collapse"+t._id,"data-parent":"#accordionList"},s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",null,t.title,t.subtitle?s.a.createElement("span",null,": ",s.a.createElement("small",null,t.subtitle)):s.a.createElement("span",null)),s.a.createElement("div",null,s.a.createElement("p",null,t.description),s.a.createElement("div",{className:"row"}),s.a.createElement("div",null,t.categories?s.a.createElement("span",null,t.categories.join()):s.a.createElement("span",null)),s.a.createElement("div",null,t.pages?s.a.createElement("span",null,t.pages,"pp"):s.a.createElement("span",null)),s.a.createElement("div",null,t.publisher?s.a.createElement("span",null,t.publisher):s.a.createElement("span",null)),s.a.createElement("span",null,t.isbn13?s.a.createElement("span",null,"ISBN: ",t.isbn13):s.a.createElement("span",null))))))},L=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"renderBookListItems",value:function(){var e=this;if(this.props.books)return this.props.books.map(function(t){return[s.a.createElement(w,{book:t,bookUpdatingId:e.props.bookUpdatingId,key:t._id,clickHandler:e.props.clickHandler,selectHandler:e.props.selectHandler,handleStarClick:e.props.handleStarClick})]})}},{key:"renderSpinner",value:function(){return s.a.createElement("div",{className:"text-center mt-3"},s.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading...")))}},{key:"renderBookList",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"accordion",id:"accordionList"},this.renderBookListItems()),s.a.createElement("div",{className:"d-flex justify-content-end"},s.a.createElement("div",{className:"mr-2"},s.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"new book"},s.a.createElement("span",{className:"mr-3 text-success","data-toggle":"modal","data-target":"#"+y.modalName,onClick:function(){e.props.newHandler()}},s.a.createElement("span",{style:{fontSize:"1.2em"}},s.a.createElement("i",{className:"far fa-plus-square"})),s.a.createElement("span",{className:"ml-2"},"Add"))))))}},{key:"render",value:function(){return s.a.createElement("div",{className:"row justify-content-center"},s.a.createElement("div",{className:"col-11"},this.renderBookList(),this.props.isLoading?this.renderSpinner():s.a.createElement("span",null)))}}]),t}(n.Component);var U=function(e){return s.a.createElement("div",null,e.isGoogleLoading?s.a.createElement("div",null,s.a.createElement("div",{className:"text-center mt-3"},s.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading...")))):s.a.createElement("div",null,function(e){return s.a.createElement("div",null,e.books.length>0?s.a.createElement("table",{className:"table table-hover"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{scope:"col"},"Title"),s.a.createElement("th",{scope:"col"},"Subtitle"),s.a.createElement("th",{scope:"col"},"Author(s)"),s.a.createElement("th",null,"?"))),s.a.createElement("tbody",null,e.books.map(function(t,a){return s.a.createElement("tr",{key:a},s.a.createElement("th",{scope:"row"},s.a.createElement("small",null,t.title)),s.a.createElement("td",null,s.a.createElement("small",null,t.subtitle)),s.a.createElement("td",null,s.a.createElement("small",null,t.authors?t.authors.join():"")),s.a.createElement("td",null,s.a.createElement("span",{className:"text-secondary",onClick:function(){e.handleGoogleBookSelect(t.googleBooksId)}},s.a.createElement("i",{className:"fas fa-arrow-circle-right"}))))}))):s.a.createElement("span",null))}(e)))},x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleSave=a.handleSave.bind(Object(h.a)(a)),a.handleGoogleLookup=a.handleGoogleLookup.bind(Object(h.a)(a)),a.handleGoogleBookSelect=a.handleGoogleBookSelect.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value;this.props.handleChange(t,a)}},{key:"handleSave",value:function(){this.props.handleSave()}},{key:"handleGoogleLookup",value:function(){this.props.handleGoogleLookup()}},{key:"handleGoogleBookSelect",value:function(e){this.props.handleGoogleBookSelect(e)}},{key:"render",value:function(){var e=this.props.book,t="Edit Book";return"new"===this.props.mode&&(t="New Book"),s.a.createElement("div",{className:"modal fade",id:y.modalName,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog modal-xl",role:"document"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("form",null,s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},t),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"form-group col"},s.a.createElement("div",{className:"input-group"},s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("label",{htmlFor:"bookTitle"},s.a.createElement("span",{id:"titleHelp",className:"input-group-text"},"Book Title"))),s.a.createElement("input",{type:"text",className:"form-control",id:"bookTitle","aria-describedby":"titleHelp",placeholder:"Book Title",name:"title",value:e.title,onChange:this.handleChange}),s.a.createElement("div",{className:"input-group-append"},s.a.createElement("button",{type:"button",className:"btn btn-primary mb-3",onClick:this.handleGoogleLookup},"Google")))),s.a.createElement("div",{className:"form-group col"},s.a.createElement("div",{className:"input-group"},s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("label",{htmlFor:"bookAuthor"},s.a.createElement("small",{id:"authorHelp",className:"input-group-text"},"Author"))),s.a.createElement("input",{type:"text",className:"form-control",id:"bookAuthor","aria-describedby":"authorHelp",placeholder:"Author",name:"author",value:e.author,onChange:this.handleChange})))),s.a.createElement("div",null,s.a.createElement(U,{books:this.props.googleBooksData,isGoogleLoading:this.props.isGoogleLoading,handleGoogleBookSelect:this.handleGoogleBookSelect}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),s.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:this.handleSave},"Save changes"))))))}}]),t}(n.Component);var T=function(e){return s.a.createElement("div",{className:"modal fade yes-no-modal",tabIndex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-body"},s.a.createElement("span",null,e.msg)),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),s.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:e.handleOkClick},"OK")))))},I=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={toasts:[]},a.removeToast=a.removeToast.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"addToast",value:function(e){var t=this.state.toasts;t.push(e),this.setState(Object(i.a)({},this.state,{toasts:t}))}},{key:"removeToast",value:function(e){var t=this.state.toasts.filter(function(t){return t.message!==e.message});this.setState(Object(i.a)({},this.state,{toasts:t}))}},{key:"render",value:function(){var e={width:"250px",zIndex:999},t=this.removeToast,a=this.state.toasts;return s.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"fixed",top:120,right:10,minHeight:"200px"}},s.a.createElement("div",{style:{position:"absolute",top:0,right:0}},a.length>0?this.state.toasts.map(function(a,n){return window.$(".toast").toast("show"),window.$(".toast").on("hidden.bs.toast",function(){t(a)}),s.a.createElement("div",{className:"toast",style:e,role:"alert",key:n,"aria-live":"assertive","aria-atomic":"true","data-delay":"2000"},s.a.createElement("div",{className:"toast-header bg-light"},s.a.createElement("strong",{className:"mr-auto"},"Funky Books"),s.a.createElement("small",null,"recently"),s.a.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"toast-body"},a.message))}):""))}}]),t}(n.Component);var F=function(e){var t="none"===e.activeItem?"fas fa-filter mr-1":"fas fa-filter mr-1 text-warning";return s.a.createElement("div",{className:"dropdown"},s.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},s.a.createElement("span",null,s.a.createElement("i",{className:t}),e.buttonText)),s.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return e.map(function(e,n){return s.a.createElement("div",{className:e.value===t?"dropdown-item active":"dropdown-item",key:n,"data-value":e.value,onClick:function(e){a(e.target.getAttribute("data-value"))}},e.name)})}(e.items,e.activeItem,e.changeHandler)))};var M=function(e){return s.a.createElement("nav",{className:"navbar sticky-top navbar-expand-lg navbar-light bg-light"},"  ",s.a.createElement("span",{className:"navbar-brand mb-0 h1"},"My Booklist"),s.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},s.a.createElement("span",{className:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},s.a.createElement("ul",{className:"navbar-nav mr-auto"}),s.a.createElement("div",{className:"mr-1"},s.a.createElement(F,{items:y.statusOptions,activeItem:e.statusFilter,buttonText:"Status",changeHandler:e.handleStatusFilterChange})),s.a.createElement("div",{className:"mr-1"},s.a.createElement(F,{items:y.priorityOptions,activeItem:e.priorityFilter,buttonText:"Stars",changeHandler:e.handlePriorityFilterChange})),s.a.createElement("form",{className:"form-inline my-2 my-lg-0",onSubmit:function(e){e.preventDefault()}},s.a.createElement("input",{className:"form-control mr-sm-2",type:"search",placeholder:"Search","aria-label":"Search",value:e.searchTerm,onChange:function(t){return e.handleSearchChange(t.target.value)}}),s.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"button",onClick:e.handleSearchClick},"Search"))))},A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={books:[],booksCache:[],activeBook:{_id:"",title:"",author:"",year:0,status:"none",priority:0,googleBooksId:"",userid:""},modalMode:"edit",searchTerm:"",yesNoModal:{text:"Do you really want to delete "},googleBooksData:{},statusFilter:"none",priorityFilter:"none",status:{isBookListLoading:!1,isGoogleLoading:!1,bookUpdatingId:!1}},a.handleSearchClick=a.handleSearchClick.bind(Object(h.a)(a)),a.handleSearchChange=a.handleSearchChange.bind(Object(h.a)(a)),a.handleStatusFilterChange=a.handleStatusFilterChange.bind(Object(h.a)(a)),a.handlePriorityFilterChange=a.handlePriorityFilterChange.bind(Object(h.a)(a)),a.handleEditModalChange=a.handleEditModalChange.bind(Object(h.a)(a)),a.handleEditModalSave=a.handleEditModalSave.bind(Object(h.a)(a)),a.handleGoogleLookup=a.handleGoogleLookup.bind(Object(h.a)(a)),a.handleGoogleBookSelect=a.handleGoogleBookSelect.bind(Object(h.a)(a)),a.handleListItemClick=a.handleListItemClick.bind(Object(h.a)(a)),a.deleteActiveBook=a.deleteActiveBook.bind(Object(h.a)(a)),a.handleNewClick=a.handleNewClick.bind(Object(h.a)(a)),a.handleSelectChange=a.handleSelectChange.bind(Object(h.a)(a)),a.handleStarClick=a.handleStarClick.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.toaster=s.a.createRef(),this.props.user.authdata&&(this.setState({status:Object(i.a)({},this.state.status,{isBookListLoading:!0})}),this.getBookList("",this.props.user.authdata))}},{key:"setActiveBook",value:function(e){var t=this.state.books.filter(function(t){return t._id===e});this.setState({activeBook:t[0],modalMode:"edit"})}},{key:"getBookList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.setState({status:Object(i.a)({},this.state.status,{isBookListLoading:!0})});var n=""===t?"":"?title="+t,s=y.baseUrl+n,l={headers:{Authorization:"Basic "+(""!==a?a:this.props.user.authdata)}};b.a.get(s,l).then(function(t){e.setState({books:t.data,booksCache:t.data,status:Object(i.a)({},e.state.status,{isBookListLoading:!1})})}).catch(function(t){console.log(t),e.toaster.current.addToast({message:"Error retrieving book list... Please try again."}),e.setState({error:!0,status:Object(i.a)({},e.state.status,{isBookListLoading:!1})})})}},{key:"filterBookList",value:function(e,t){var a=[];"status"===e?"none"===t?(a=this.state.booksCache,this.setState({priorityFilter:"none"})):a=this.state.booksCache.filter(function(e){return e.status===t}):"priority"===e&&("none"===t?(a=this.state.booksCache,this.setState({statusFilter:"none"})):a=this.state.booksCache.filter(function(e){return e.priority===parseInt(t)})),a!==[]&&this.setState({books:a})}},{key:"createBook",value:function(){var e=Object(B.a)(O.a.mark(function e(t){var a,n,s=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.baseUrl,e.next=3,this.getAuth();case 3:n=e.sent,b.a.post(a,t,n).then(function(e){200===e.status&&(console.log(t.title,"created successfully"),s.toaster.current.addToast({message:"Book added: '".concat(t.title,"'")}),s.getBookList())}).catch(function(e){s.setState({error:!0}),s.toaster.current.addToast({message:"Couldn't create book... Please try again."})});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBook",value:function(){var e=Object(B.a)(O.a.mark(function e(t,a){var n,s,l=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.baseUrl+"?id="+t,e.next=3,this.getAuth();case 3:s=e.sent,b.a.delete(n,s).then(function(e){200===e.status&&(l.toaster.current.addToast({message:"Book deleted: '".concat(a,"'")}),l.getBookList())}).catch(function(e){l.setState({error:!0}),l.toaster.current.addToast({message:"Couldn't delete book... Please try again."})});case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"updateBook",value:function(){var e=Object(B.a)(O.a.mark(function e(t){var a,n,s=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:Object(i.a)({},this.status,{bookUpdatingId:t._id})}),a=y.baseUrl,e.next=4,this.getAuth();case 4:n=e.sent,b.a.patch(a,t,n).then(function(e){200===e.status&&(s.setState({status:Object(i.a)({},s.status,{bookUpdatingId:""})}),s.toaster.current.addToast({message:"Book updated: '".concat(t.title,"'")}),s.getBookList())}).catch(function(e){s.setState({error:!0,status:Object(i.a)({},s.status,{bookUpdatingId:""})}),s.toaster.current.addToast({message:"Couldn't update book... Please try again."})});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGoogleBooksData",value:function(){var e=Object(B.a)(O.a.mark(function e(t){var a,n,s=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:Object(i.a)({},this.state.status,{isGoogleLoading:!0})}),a=y.searchUrl+"?q="+t,e.next=4,this.getAuth();case 4:n=e.sent,b.a.get(a,n).then(function(e){s.setState({googleBooksData:e.data,status:Object(i.a)({},s.state.status,{isGoogleLoading:!1})})}).catch(function(e){s.setState({error:!0,status:Object(i.a)({},s.state.status,{isGoogleLoading:!1})}),s.toaster.current.addToast({message:"Couldn't get Google Books data... Please try again."})});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAuth",value:function(){return{headers:{Authorization:"Basic ".concat(this.props.user.authdata)}}}},{key:"handleEditModalChange",value:function(e,t){this.setState({activeBook:Object(i.a)({},this.state.activeBook,Object(r.a)({},e,t))})}},{key:"handleEditModalSave",value:function(){"new"===this.state.modalMode?this.createBook(this.state.activeBook):this.updateBook(this.state.activeBook)}},{key:"handleListItemClick",value:function(e){this.setActiveBook(e)}},{key:"handleSearchChange",value:function(e){this.setState({searchTerm:e}),""===e&&this.getBookList()}},{key:"handleSearchClick",value:function(e){this.getBookList(this.state.searchTerm)}},{key:"deleteActiveBook",value:function(){this.deleteBook(this.state.activeBook._id,this.state.activeBook.title)}},{key:"handleNewClick",value:function(){this.setState({modalMode:"new",activeBook:{id:"",title:"",author:"",year:0,status:"",priority:0,userid:this.props.user._id},googleBooksData:{}})}},{key:"handleGoogleLookup",value:function(){this.getGoogleBooksData(this.state.activeBook.title)}},{key:"handleGoogleBookSelect",value:function(e){var t=this.state.googleBooksData.filter(function(t){return t.googleBooksId===e})[0],a=t.authors.join();this.setState({activeBook:Object(i.a)({},this.state.activeBook,{googleBooksId:e,title:t.title,author:a,categories:t.categories,description:t.description,isbn10:t.isbn10,isbn13:t.isbn13,pages:t.pages,publisher:t.publisher,snippet:t.snippet,subtitle:t.subtitle,date:t.date})})}},{key:"handleSelectChange",value:function(){var e=Object(B.a)(O.a.mark(function e(t,a){var n,s;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.value,s=0;case 2:if(!(s<this.state.books.length)){e.next=13;break}if(this.state.books[s]._id!==a){e.next=10;break}return e.next=6,this.setActiveBook(a);case 6:return e.next=8,this.setState({activeBook:Object(i.a)({},this.state.activeBook,{status:n})});case 8:return e.next=10,this.updateBook(this.state.activeBook);case 10:s++,e.next=2;break;case 13:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleStatusFilterChange",value:function(e){this.setState({statusFilter:e}),this.filterBookList("status",e)}},{key:"handlePriorityFilterChange",value:function(e){this.setState({priorityFilter:e}),this.filterBookList("priority",e)}},{key:"handleStarClick",value:function(){var e=Object(B.a)(O.a.mark(function e(t,a){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.state.books.length)){e.next=12;break}if(this.state.books[n]._id!==a){e.next=9;break}return e.next=5,this.setActiveBook(a);case 5:return e.next=7,this.setState({activeBook:Object(i.a)({},this.state.activeBook,{priority:t})});case 7:return e.next=9,this.updateBook(this.state.activeBook);case 9:n++,e.next=1;break;case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(M,{handleSearchClick:this.handleSearchClick,searchTerm:this.state.searchTerm,handleSearchChange:this.handleSearchChange,statusFilter:this.state.statusFilter,handleStatusFilterChange:this.handleStatusFilterChange,priorityFilter:this.state.priorityFilter,handlePriorityFilterChange:this.handlePriorityFilterChange}),s.a.createElement(L,{books:this.state.books,clickHandler:this.handleListItemClick,selectHandler:this.handleSelectChange,newHandler:this.handleNewClick,handleStarClick:this.handleStarClick,isLoading:this.state.status.isBookListLoading,bookUpdatingId:this.state.status.bookUpdatingId}),s.a.createElement(x,{book:this.state.activeBook,handleChange:this.handleEditModalChange,handleSave:this.handleEditModalSave,mode:this.state.modalMode,googleBooksData:this.state.googleBooksData,isGoogleLoading:this.state.status.isGoogleLoading,handleGoogleLookup:this.handleGoogleLookup,handleGoogleBookSelect:this.handleGoogleBookSelect}),s.a.createElement(T,{msg:this.state.yesNoModal.text+this.state.activeBook.title+"?",handleOkClick:this.deleteActiveBook}),s.a.createElement(I,{ref:this.toaster}),s.a.createElement("footer",null,s.a.createElement("p",null),s.a.createElement("p",null)))}}]),t}(n.Component);var G=function(e){return s.a.createElement("div",{className:"modal fade login-modal",tabIndex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("form",null,s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",null,"Login")),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"inputUsername"},"Username"),s.a.createElement("input",{type:"text",className:"form-control",id:"inputUsername","aria-describedby":"usernameHelp",placeholder:"Enter username",value:e.login.username,name:"username",onChange:function(t){e.handleChange(t.target.name,t.target.value)}})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"inputPassword"},"Password"),s.a.createElement("input",{type:"password",className:"form-control",id:"inputPassword",placeholder:"",value:e.login.password,name:"password",onChange:function(t){e.handleChange(t.target.name,t.target.value)}}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),s.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:e.handleSubmit},"Submit"))))))},_=function(e){function t(){var e;Object(c.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={user:{_id:"",username:"",email:"",role:"",authdata:""},login:{username:"",password:""}},e.handleLoginChange=e.handleLoginChange.bind(Object(h.a)(e)),e.handleLoginSubmit=e.handleLoginSubmit.bind(Object(h.a)(e)),e.handleLogout=e.handleLogout.bind(Object(h.a)(e));var a=JSON.parse(localStorage.getItem("user"));return a&&(e.state.user={username:a.username,authdata:a.authdata,_id:a._id,email:a.email,role:a.role}),window.$(function(){window.$('[data-toggle="tooltip"]').tooltip(),window.$('[data-toggle="popover"]').popover(),window.$(".toast").toast({autohide:!0,delay:5e3})}),e}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.appToaster=s.a.createRef(),this.bookListContainer=s.a.createRef()}},{key:"handleLoginChange",value:function(e,t){this.setState({login:Object(i.a)({},this.state.login,Object(r.a)({},e,t))})}},{key:"handleLoginSubmit",value:function(e){var t=this,a=y.loginUrl,n=this.state.login.username,s=this.state.login.password,l=window.btoa(n+":"+s),o={headers:{Authorization:"Basic "+l}};b.a.get(a,o).then(function(e){var a=e.data,n={_id:a._id,username:a.username,email:a.email,role:a.role,authdata:l};localStorage.setItem("user",JSON.stringify(n)),t.setState({user:n,login:{username:"",password:""}}),t.appToaster.current.addToast({message:"Login success!  Welcome ".concat(n.username)}),t.bookListContainer.current.getBookList()}).catch(function(e){t.setState({error:!0}),console.error(e),t.appToaster.current.addToast({message:"Login failed!  Please try again."})})}},{key:"handleLogout",value:function(){this.appToaster.current.addToast({message:"Logged out successfully."}),this.setState({books:[],booksCache:[],activeBook:{_id:"",title:"",author:"",year:0,status:"none",priority:0,googleBooksId:"",userid:""},user:{_id:"",username:"",email:"",role:"",authdata:""}}),localStorage.removeItem("user")}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(k,{user:this.state.user,handleLogout:this.handleLogout}),s.a.createElement(I,{ref:this.appToaster}),s.a.createElement(G,{login:this.state.login,handleChange:this.handleLoginChange,handleSubmit:this.handleLoginSubmit}),s.a.createElement(v.a,null,s.a.createElement(E.a,{path:"/",exact:!0,render:function(t){return s.a.createElement(A,Object.assign({ref:e.bookListContainer},t,{user:e.state.user}))}}),s.a.createElement(E.a,{path:"/users/",component:C})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.ae367af8.chunk.js.map