(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(51)},47:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(23),s=a.n(l),r=a(12),i=a(4),c=a.n(i),d=a(10),u=a(2),m=a(5),h=a(6),p=a(8),g=a(7),b=a(1),v=a(9),k=a(11),E=a.n(k);a(47);var f=function(e){var t="none"===e.activeItem?"fas fa-filter mr-1":"fas fa-filter mr-1 text-warning";return o.a.createElement("div",{className:"dropdown"},o.a.createElement("button",{className:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},o.a.createElement("span",null,o.a.createElement("i",{className:t}),e.buttonText)),o.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return e.map(function(e,n){return o.a.createElement("div",{className:e.value===t?"dropdown-item active":"dropdown-item",key:n,"data-value":e.value,onClick:function(e){a(e.target.getAttribute("data-value"))}},e.name)})}(e.items,e.activeItem,e.changeHandler)))};a(48).config();var y="https://limitless-headland-66330.herokuapp.com",N={modalName:"bookEditModal",baseUrl:y+"/api/v1/books",searchUrl:y+"/api/v1/external/google/volumes",routesUrl:y+"/routes",loginUrl:y+"/login",statusOptions:[{name:"None",value:"none"},{name:"Wishlist",value:"wishlist"},{name:"On Order",value:"onOrder"},{name:"Purchased",value:"purchased"},{name:"Reading",value:"reading"},{name:"Read",value:"read"}],priorityOptions:[{name:"None",value:"none"},{name:"0",value:0},{name:"1",value:1},{name:"2",value:2},{name:"3",value:3},{name:"4",value:4},{name:"5",value:5}]},S=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).handleSearchChange=a.handleSearchChange.bind(Object(b.a)(a)),a.handleSearchClick=a.handleSearchClick.bind(Object(b.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(b.a)(a)),a.handleStatusFilterChange=a.handleStatusFilterChange.bind(Object(b.a)(a)),a.handlePriorityFilterChange=a.handlePriorityFilterChange.bind(Object(b.a)(a)),a.handleLogout=a.handleLogout.bind(Object(b.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleSearchChange",value:function(e){var t=e.target.value;this.props.handleSearchChange(t)}},{key:"handleSearchClick",value:function(){this.props.handleSearchClick()}},{key:"handleSubmit",value:function(e){this.props.handleSearchClick(),e.preventDefault()}},{key:"handlePriorityFilterChange",value:function(e){this.props.handlePriorityFilterChange(e)}},{key:"handleStatusFilterChange",value:function(e){this.props.handleStatusFilterChange(e)}},{key:"handleLogout",value:function(){this.props.handleLogout()}},{key:"render",value:function(){var e=this.props.user.username||"";return o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},o.a.createElement("span",{className:"navbar-brand mb-0 h1"},o.a.createElement("i",{className:"fas fa-book"})," Funky Books"),o.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"})),o.a.createElement("div",{className:"ml-2 mr-2"},""===e?o.a.createElement("button",{type:"button",className:"btn btn-outline-primary btn-sm","data-toggle":"modal","data-target":".login-modal"},"Login"):o.a.createElement("div",null,o.a.createElement("span",{className:"mr-1"},e),o.a.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:this.handleLogout},"Logout")," ")),o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},o.a.createElement("ul",{className:"navbar-nav mr-auto"}),o.a.createElement("div",{className:"mr-1"},o.a.createElement(f,{items:N.statusOptions,activeItem:this.props.statusFilter,buttonText:"Status",changeHandler:this.handleStatusFilterChange})),o.a.createElement("div",{className:"mr-1"},o.a.createElement(f,{items:N.priorityOptions,activeItem:this.props.priorityFilter,buttonText:"Stars",changeHandler:this.handlePriorityFilterChange})),o.a.createElement("form",{className:"form-inline my-2 my-lg-0",onSubmit:this.handleSubmit},o.a.createElement("input",{className:"form-control mr-sm-2",type:"search",placeholder:"Search","aria-label":"Search",value:this.props.searchTerm,onChange:this.handleSearchChange}),o.a.createElement("button",{className:"btn btn-outline-success my-2 my-sm-0",type:"button",onClick:this.handleSearchClick},"Search"))))}}]),t}(n.Component),C=o.a.createElement("i",{className:"far fa-star"}),B=o.a.createElement("i",{className:"fas fa-star"});var O=function(e){var t=function(e,t){for(var a=[],n=1;n<t+1;n++)n<=e?a.push(1):a.push(0);return a}(e.priority,5);return o.a.createElement("div",{className:"row text-warning"},t.map(function(e,t){return 1===e?o.a.createElement("span",{key:t},B):o.a.createElement("span",{key:t},C)}))};var w=function(e){var t=e.book,a="https://books.google.com/books/content?id=";t.googleBooksId&&""!==t.googleBooksId?a+=t.googleBooksId:a+="ZlU3DwAAQBAJ",a+="&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api";var n="";return t.snippet&&(n=(n=t.snippet.replace(/&quot;/g,'"')).replace(/&#39;/g,"'")),o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-header"},o.a.createElement("div",{className:"media"},o.a.createElement("img",{src:a,className:"mr-2 bl-thumb",alt:"book cover"}),o.a.createElement("div",{className:"media-body"},o.a.createElement("div",{className:"container-fluid row"},o.a.createElement("div",{className:"col-3"},o.a.createElement("h5",{className:"mt-0"},t.title||"loading"," "),o.a.createElement("div",{className:"d-flex flex-row justify-content-between"},o.a.createElement("div",null,t.author,"   ",o.a.createElement("span",null,t.year?o.a.createElement("span",null,"(",t.year,")"):o.a.createElement("span",null))))),o.a.createElement("div",{className:"col-6",style:{position:"relative"}},o.a.createElement("p",null,o.a.createElement("small",null,n)),e.bookUpdatingId===e.book._id?o.a.createElement("div",{className:"col-12 text-center mt-3",style:{position:"absolute",left:"0px",top:"0px"}},o.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading..."))):o.a.createElement("span",null)),o.a.createElement("div",{className:"col-3"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-6"},o.a.createElement("div",{className:"mr-1 mb-4"},o.a.createElement("select",{value:t.status||"",onChange:function(a){e.selectHandler(a,t._id)}},o.a.createElement("option",{value:"wishlist"},"Wishlist"),o.a.createElement("option",{value:"onOrder"},"On Order"),o.a.createElement("option",{value:"purchased"},"Purchased"),o.a.createElement("option",{value:"reading"},"Reading"),o.a.createElement("option",{value:"read"},"Read"))),o.a.createElement("div",{className:"mr-1 ml-3"},o.a.createElement(O,{priority:t.priority}))),o.a.createElement("div",{className:"col-6"},o.a.createElement("div",{className:"mr-1 ml-3 mb-3"},o.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"edit book"},o.a.createElement("span",{style:{fontSize:"1.2em"},className:"mr-3 text-primary","data-toggle":"modal","data-target":"#"+N.modalName,onClick:function(){e.clickHandler(t._id)}},o.a.createElement("i",{className:"fas fa-edit"}))),o.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"delete book"},o.a.createElement("span",{style:{fontSize:"1.2em"},className:"text-danger","data-toggle":"modal","data-target":".yes-no-modal",onClick:function(){e.clickHandler(t._id)}},o.a.createElement("i",{className:"fas fa-trash-alt"})))),o.a.createElement("div",{className:""},o.a.createElement("button",{type:"button",className:"btn btn-link","data-toggle":"collapse","data-target":"#collapse"+t._id},o.a.createElement("small",null,"details...")))))))))),o.a.createElement("div",{className:"collapse",id:"collapse"+t._id,"data-parent":"#accordionList"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",null,t.title,t.subtitle?o.a.createElement("span",null,": ",o.a.createElement("small",null,t.subtitle)):o.a.createElement("span",null)),o.a.createElement("div",null,o.a.createElement("p",null,t.description),o.a.createElement("div",{className:"row"}),o.a.createElement("div",null,t.categories?o.a.createElement("span",null,t.categories.join()):o.a.createElement("span",null)),o.a.createElement("div",null,t.pages?o.a.createElement("span",null,t.pages,"pp"):o.a.createElement("span",null)),o.a.createElement("div",null,t.publisher?o.a.createElement("span",null,t.publisher):o.a.createElement("span",null)),o.a.createElement("span",null,t.isbn13?o.a.createElement("span",null,"ISBN: ",t.isbn13):o.a.createElement("span",null))))))},L=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"renderBookListItems",value:function(){var e=this;if(this.props.books)return this.props.books.map(function(t){return[o.a.createElement(w,{book:t,bookUpdatingId:e.props.bookUpdatingId,key:t._id,clickHandler:e.props.clickHandler,selectHandler:e.props.selectHandler})]})}},{key:"renderSpinner",value:function(){return o.a.createElement("div",{className:"text-center mt-3"},o.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading...")))}},{key:"renderBookList",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{className:"accordion",id:"accordionList"},this.renderBookListItems()),o.a.createElement("div",{className:"d-flex justify-content-end"},o.a.createElement("div",{className:"mr-2"},o.a.createElement("span",{"data-toggle":"tooltip","data-placement":"top",title:"new book"},o.a.createElement("span",{className:"mr-3 text-success","data-toggle":"modal","data-target":"#"+N.modalName,onClick:function(){e.props.newHandler()}},o.a.createElement("span",{style:{fontSize:"1.2em"}},o.a.createElement("i",{className:"far fa-plus-square"})),o.a.createElement("span",{className:"ml-2"},"Add"))))))}},{key:"render",value:function(){return o.a.createElement("div",{className:"row justify-content-center"},o.a.createElement("div",{className:"col-10"},this.renderBookList(),this.props.isLoading?this.renderSpinner():o.a.createElement("span",null)))}}]),t}(n.Component);var j=function(e){return o.a.createElement("div",null,e.isGoogleLoading?o.a.createElement("div",null,o.a.createElement("div",{className:"text-center mt-3"},o.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading...")))):o.a.createElement("div",null,function(e){return o.a.createElement("div",null,e.books.length>0?o.a.createElement("table",{className:"table table-hover"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"col"},"Title"),o.a.createElement("th",{scope:"col"},"Subtitle"),o.a.createElement("th",{scope:"col"},"Author(s)"),o.a.createElement("th",null,"?"))),o.a.createElement("tbody",null,e.books.map(function(t,a){return o.a.createElement("tr",{key:a},o.a.createElement("th",{scope:"row"},o.a.createElement("small",null,t.title)),o.a.createElement("td",null,o.a.createElement("small",null,t.subtitle)),o.a.createElement("td",null,o.a.createElement("small",null,t.authors?t.authors.join():"")),o.a.createElement("td",null,o.a.createElement("span",{className:"text-secondary",onClick:function(){e.handleGoogleBookSelect(t.googleBooksId)}},o.a.createElement("i",{className:"fas fa-arrow-circle-right"}))))}))):o.a.createElement("span",null))}(e)))},x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(b.a)(a)),a.handleSave=a.handleSave.bind(Object(b.a)(a)),a.handleGoogleLookup=a.handleGoogleLookup.bind(Object(b.a)(a)),a.handleGoogleBookSelect=a.handleGoogleBookSelect.bind(Object(b.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value;this.props.handleChange(t,a)}},{key:"handleSave",value:function(){this.props.handleSave()}},{key:"handleGoogleLookup",value:function(){this.props.handleGoogleLookup()}},{key:"handleGoogleBookSelect",value:function(e){this.props.handleGoogleBookSelect(e)}},{key:"render",value:function(){var e=this.props.book,t="Edit Book";return"new"===this.props.mode&&(t="New Book"),o.a.createElement("div",{className:"modal fade",id:N.modalName,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog modal-xl",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("form",null,o.a.createElement("div",{className:"modal-header"},o.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},t),o.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"modal-body"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-group col"},o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("label",{htmlFor:"bookTitle"},o.a.createElement("span",{id:"titleHelp",className:"input-group-text"},"Book Title"))),o.a.createElement("input",{type:"text",className:"form-control",id:"bookTitle","aria-describedby":"titleHelp",placeholder:"Book Title",name:"title",value:e.title,onChange:this.handleChange}),o.a.createElement("div",{className:"input-group-append"},o.a.createElement("button",{type:"button",className:"btn btn-primary mb-3",onClick:this.handleGoogleLookup},"Google")))),o.a.createElement("div",{className:"form-group col"},o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("label",{htmlFor:"bookAuthor"},o.a.createElement("small",{id:"authorHelp",className:"input-group-text"},"Author"))),o.a.createElement("input",{type:"text",className:"form-control",id:"bookAuthor","aria-describedby":"authorHelp",placeholder:"Author",name:"author",value:e.author,onChange:this.handleChange})))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"form-group col"},o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("label",{htmlFor:"bookStatus"}," ",o.a.createElement("small",{id:"statusHelp",className:"input-group-text"},"Status"))),o.a.createElement("input",{type:"text",className:"form-control",id:"bookStatus","aria-describedby":"statusHelp",placeholder:"Status",name:"status",value:e.status,onChange:this.handleChange}))),o.a.createElement("div",{className:"form-group col"},o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("label",{htmlFor:"bookYear"}," ",o.a.createElement("small",{id:"yearHelp",className:"input-group-text"},"First published"))),o.a.createElement("input",{type:"text",className:"form-control",id:"bookYear","aria-describedby":"yearHelp",placeholder:"Year",name:"year",value:e.year,onChange:this.handleChange}))),o.a.createElement("div",{className:"form-group col"},o.a.createElement("div",{className:"input-group"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("label",{htmlFor:"bookPriority"}," ",o.a.createElement("small",{id:"priorityHelp",className:"input-group-text"},"Priority"))),o.a.createElement("input",{type:"text",className:"form-control",id:"bookPriority","aria-describedby":"priorityHelp",placeholder:"Priority",name:"priority",value:e.priority,onChange:this.handleChange})))),o.a.createElement("div",null,o.a.createElement(j,{books:this.props.googleBooksData,isGoogleLoading:this.props.isGoogleLoading,handleGoogleBookSelect:this.handleGoogleBookSelect}))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:this.handleSave},"Save changes"))))))}}]),t}(n.Component);var F=function(e){return o.a.createElement("div",{className:"modal fade yes-no-modal",tabIndex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-body"},o.a.createElement("span",null,e.msg)),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:e.handleOkClick},"OK")))))};var I=function(e){return o.a.createElement("div",{className:"modal fade login-modal",tabIndex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("form",null,o.a.createElement("div",{className:"modal-header"},o.a.createElement("h5",null,"Login")),o.a.createElement("div",{className:"modal-body"},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"inputUsername"},"Username"),o.a.createElement("input",{type:"text",className:"form-control",id:"inputUsername","aria-describedby":"usernameHelp",placeholder:"Enter username",value:e.login.username,name:"username",onChange:function(t){e.handleChange(t.target.name,t.target.value)}})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"inputPassword"},"Password"),o.a.createElement("input",{type:"password",className:"form-control",id:"inputPassword",placeholder:"",value:e.login.password,name:"password",onChange:function(t){e.handleChange(t.target.name,t.target.value)}}))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:e.handleSubmit},"Submit"))))))},G=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={toasts:[{message:"Welcome to Funky Books! \n New Notifications appear here."}]},a.removeToast=a.removeToast.bind(Object(b.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"addToast",value:function(e){var t=this.state.toasts;t.push(e),this.setState(Object(u.a)({},this.state,{toasts:t}))}},{key:"removeToast",value:function(e){var t=this.state.toasts.filter(function(t){return t.message!==e.message});this.setState(Object(u.a)({},this.state,{toasts:t}))}},{key:"render",value:function(){var e={width:"250px",zIndex:999},t=this.removeToast,a=this.state.toasts;return o.a.createElement("div",{"aria-live":"polite","aria-atomic":"true",style:{position:"absolute",top:50,right:10,minHeight:"200px"}},o.a.createElement("div",{style:{position:"absolute",top:0,right:0}},a.length>0?this.state.toasts.map(function(a,n){return window.$(".toast").toast("show"),window.$(".toast").on("hidden.bs.toast",function(){t(a)}),o.a.createElement("div",{className:"toast",style:e,role:"alert",key:n,"aria-live":"assertive","aria-atomic":"true","data-delay":"2000"},o.a.createElement("div",{className:"toast-header"},o.a.createElement("strong",{className:"mr-auto"},"Funky Books"),o.a.createElement("small",null,"recently"),o.a.createElement("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"toast-body"},a.message))}):""))}}]),t}(n.Component),T=function(e){function t(){var e;Object(m.a)(this,t),(e=Object(p.a)(this,Object(g.a)(t).call(this))).state={books:[],booksCache:[],activeBook:{_id:"",title:"",author:"",year:0,status:"none",priority:0,googleBooksId:"",userid:""},modalMode:"edit",searchTerm:"",yesNoModal:{text:"Do you really want to delete "},googleBooksData:{},statusFilter:"none",priorityFilter:"none",user:{_id:"",username:"",email:"",role:"",authdata:""},login:{username:"",password:""},status:{isBookListLoading:!1,isGoogleLoading:!1,bookUpdatingId:!1}},e.handleListItemClick=e.handleListItemClick.bind(Object(b.a)(e)),e.handleEditModalChange=e.handleEditModalChange.bind(Object(b.a)(e)),e.handleEditModalSave=e.handleEditModalSave.bind(Object(b.a)(e)),e.handleSearchClick=e.handleSearchClick.bind(Object(b.a)(e)),e.handleSearchChange=e.handleSearchChange.bind(Object(b.a)(e)),e.deleteActiveBook=e.deleteActiveBook.bind(Object(b.a)(e)),e.handleNewClick=e.handleNewClick.bind(Object(b.a)(e)),e.handleGoogleLookup=e.handleGoogleLookup.bind(Object(b.a)(e)),e.handleGoogleBookSelect=e.handleGoogleBookSelect.bind(Object(b.a)(e)),e.handleSelectChange=e.handleSelectChange.bind(Object(b.a)(e)),e.handleStatusFilterChange=e.handleStatusFilterChange.bind(Object(b.a)(e)),e.handlePriorityFilterChange=e.handlePriorityFilterChange.bind(Object(b.a)(e)),e.handleLoginChange=e.handleLoginChange.bind(Object(b.a)(e)),e.handleLoginSubmit=e.handleLoginSubmit.bind(Object(b.a)(e)),e.handleLogout=e.handleLogout.bind(Object(b.a)(e));var a=JSON.parse(localStorage.getItem("user"));return a&&(e.state.user={username:a.username,authdata:a.authdata,_id:a._id,email:a.email,role:a.role}),e}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.state.user.authdata&&(this.setState({status:Object(u.a)({},this.state.status,{isBookListLoading:!0})}),this.getBookList("",this.state.user.authdata)),this.toaster=o.a.createRef(),window.$(function(){window.$('[data-toggle="tooltip"]').tooltip(),window.$('[data-toggle="popover"]').popover(),window.$(".toast").toast({autohide:!0,delay:5e3})})}},{key:"getLocalUser",value:function(){var e=Object(d.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=JSON.parse(localStorage.getItem("user"))).username){e.next=6;break}return console.log("localUser:",t),this.setState({user:{username:t.username,authdata:t.authdata,_id:t._id,email:t.email,role:t.role}}),console.log("state.user",this.state.user),e.abrupt("return",t.authdata);case 6:return e.abrupt("return","");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setActiveBook",value:function(e){var t=this.state.books.filter(function(t){return t._id===e});this.setState({activeBook:t[0],modalMode:"edit"})}},{key:"getBookList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.setState({status:Object(u.a)({},this.state.status,{isBookListLoading:!0})});var n=""===t?"":"?title="+t,o=N.baseUrl+n,l={headers:{Authorization:"Basic "+(""!==a?a:this.state.user.authdata)}};E.a.get(o,l).then(function(t){e.setState({books:t.data,booksCache:t.data,status:Object(u.a)({},e.state.status,{isBookListLoading:!1})})}).catch(function(t){console.log(t),e.toaster.current.addToast({message:"Error retrieving book list... Please try again."}),e.setState({error:!0,status:Object(u.a)({},e.state.status,{isBookListLoading:!1})})})}},{key:"filterBookList",value:function(e,t){var a=[];"status"===e?"none"===t?(a=this.state.booksCache,this.setState({priorityFilter:"none"})):a=this.state.booksCache.filter(function(e){return e.status===t}):"priority"===e&&("none"===t?(a=this.state.booksCache,this.setState({statusFilter:"none"})):a=this.state.booksCache.filter(function(e){return e.priority===parseInt(t)})),a!==[]&&this.setState({books:a})}},{key:"createBook",value:function(){var e=Object(d.a)(c.a.mark(function e(t){var a,n,o=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=N.baseUrl,e.next=3,this.getAuth();case 3:n=e.sent,E.a.post(a,t,n).then(function(e){200===e.status&&(console.log(t.title,"created successfully"),o.toaster.current.addToast({message:"Book added: '".concat(t.title,"'")}),o.getBookList())}).catch(function(e){o.setState({error:!0}),o.toaster.current.addToast({message:"Couldn't create book... Please try again."})});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBook",value:function(){var e=Object(d.a)(c.a.mark(function e(t,a){var n,o,l=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=N.baseUrl+"?id="+t,e.next=3,this.getAuth();case 3:o=e.sent,E.a.delete(n,o).then(function(e){200===e.status&&(l.toaster.current.addToast({message:"Book deleted: '".concat(a,"'")}),l.getBookList())}).catch(function(e){l.setState({error:!0}),l.toaster.current.addToast({message:"Couldn't delete book... Please try again."})});case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"updateBook",value:function(){var e=Object(d.a)(c.a.mark(function e(t){var a,n,o=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:Object(u.a)({},this.status,{bookUpdatingId:t._id})}),a=N.baseUrl,e.next=4,this.getAuth();case 4:n=e.sent,E.a.patch(a,t,n).then(function(e){200===e.status&&(o.setState({status:Object(u.a)({},o.status,{bookUpdatingId:""})}),o.toaster.current.addToast({message:"Book updated: '".concat(t.title,"'")}),o.getBookList())}).catch(function(e){o.setState({error:!0,status:Object(u.a)({},o.status,{bookUpdatingId:""})}),o.toaster.current.addToast({message:"Couldn't update book... Please try again."})});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGoogleBooksData",value:function(){var e=Object(d.a)(c.a.mark(function e(t){var a,n,o=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:Object(u.a)({},this.state.status,{isGoogleLoading:!0})}),a=N.searchUrl+"?q="+t,e.next=4,this.getAuth();case 4:n=e.sent,E.a.get(a,n).then(function(e){o.setState({googleBooksData:e.data,status:Object(u.a)({},o.state.status,{isGoogleLoading:!1})})}).catch(function(e){o.setState({error:!0,status:Object(u.a)({},o.state.status,{isGoogleLoading:!1})}),o.toaster.current.addToast({message:"Couldn't get Google Books data... Please try again."})});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleEditModalChange",value:function(e,t){this.setState({activeBook:Object(u.a)({},this.state.activeBook,Object(r.a)({},e,t))})}},{key:"handleEditModalSave",value:function(){"new"===this.state.modalMode?this.createBook(this.state.activeBook):this.updateBook(this.state.activeBook)}},{key:"handleListItemClick",value:function(e){this.setActiveBook(e)}},{key:"handleSearchChange",value:function(e){this.setState({searchTerm:e}),""===e&&this.getBookList()}},{key:"handleSearchClick",value:function(e){this.getBookList(this.state.searchTerm)}},{key:"deleteActiveBook",value:function(){this.deleteBook(this.state.activeBook._id,this.state.activeBook.title)}},{key:"handleNewClick",value:function(){this.setState({modalMode:"new",activeBook:{id:"",title:"",author:"",year:0,status:"",priority:0,userid:this.state.user._id},googleBooksData:{}})}},{key:"handleGoogleLookup",value:function(){this.getGoogleBooksData(this.state.activeBook.title)}},{key:"handleGoogleBookSelect",value:function(e){var t=this.state.googleBooksData.filter(function(t){return t.googleBooksId===e})[0],a=t.authors.join();this.setState({activeBook:Object(u.a)({},this.state.activeBook,{googleBooksId:e,title:t.title,author:a,categories:t.categories,description:t.description,isbn10:t.isbn10,isbn13:t.isbn13,pages:t.pages,publisher:t.publisher,snippet:t.snippet,subtitle:t.subtitle,date:t.date})})}},{key:"handleSelectChange",value:function(){var e=Object(d.a)(c.a.mark(function e(t,a){var n,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.value,o=0;case 2:if(!(o<this.state.books.length)){e.next=13;break}if(this.state.books[o]._id!==a){e.next=10;break}return e.next=6,this.setActiveBook(a);case 6:return e.next=8,this.setState({activeBook:Object(u.a)({},this.state.activeBook,{status:n})});case 8:return e.next=10,this.updateBook(this.state.activeBook);case 10:o++,e.next=2;break;case 13:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleStatusFilterChange",value:function(e){this.setState({statusFilter:e}),this.filterBookList("status",e)}},{key:"handlePriorityFilterChange",value:function(e){this.setState({priorityFilter:e}),this.filterBookList("priority",e)}},{key:"handleLoginChange",value:function(e,t){this.setState({login:Object(u.a)({},this.state.login,Object(r.a)({},e,t))})}},{key:"handleLoginSubmit",value:function(e){var t=this,a=N.loginUrl,n=this.state.login.username,o=this.state.login.password,l=window.btoa(n+":"+o),s={headers:{Authorization:"Basic "+l}};E.a.get(a,s).then(function(e){var a=e.data,n={_id:a._id,username:a.username,email:a.email,role:a.role,authdata:l};localStorage.setItem("user",JSON.stringify(n)),t.setState({user:n,login:{username:"",password:""}}),t.toaster.current.addToast({message:"Login success!  Welcome ".concat(n.username)}),t.getBookList()}).catch(function(e){t.setState({error:!0}),console.error(e),t.toaster.current.addToast({message:"Login failed!  Please try again."})})}},{key:"handleLogout",value:function(){this.toaster.current.addToast({message:"Logged out successfully."}),this.setState({books:[],booksCache:[],activeBook:{_id:"",title:"",author:"",year:0,status:"none",priority:0,googleBooksId:"",userid:""},user:{_id:"",username:"",email:"",role:"",authdata:""}}),localStorage.removeItem("user")}},{key:"getAuth",value:function(){return{headers:{Authorization:"Basic ".concat(this.state.user.authdata)}}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(S,{handleSearchClick:this.handleSearchClick,searchTerm:this.state.searchTerm,handleSearchChange:this.handleSearchChange,statusFilter:this.state.statusFilter,handleStatusFilterChange:this.handleStatusFilterChange,priorityFilter:this.state.priorityFilter,handlePriorityFilterChange:this.handlePriorityFilterChange,user:this.state.user,handleLogout:this.handleLogout}),o.a.createElement(L,{books:this.state.books,clickHandler:this.handleListItemClick,selectHandler:this.handleSelectChange,newHandler:this.handleNewClick,isLoading:this.state.status.isBookListLoading,bookUpdatingId:this.state.status.bookUpdatingId}),o.a.createElement(x,{book:this.state.activeBook,handleChange:this.handleEditModalChange,handleSave:this.handleEditModalSave,mode:this.state.modalMode,googleBooksData:this.state.googleBooksData,isGoogleLoading:this.state.status.isGoogleLoading,handleGoogleLookup:this.handleGoogleLookup,handleGoogleBookSelect:this.handleGoogleBookSelect}),o.a.createElement(F,{msg:this.state.yesNoModal.text+this.state.activeBook.title+"?",handleOkClick:this.deleteActiveBook}),o.a.createElement(I,{login:this.state.login,handleChange:this.handleLoginChange,handleSubmit:this.handleLoginSubmit}),o.a.createElement(G,{ref:this.toaster}),o.a.createElement("footer",null,o.a.createElement("p",null),o.a.createElement("p",null)))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,1,2]]]);
//# sourceMappingURL=main.f88dc3bf.chunk.js.map